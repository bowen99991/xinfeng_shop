"use strict";(self["webpackChunkxinfeng_shop"]=self["webpackChunkxinfeng_shop"]||[]).push([[203],{3203:function(t,e,s){s.r(e),s.d(e,{default:function(){return c}});var o=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"search-box"},[e("my-nav-bar",[e("van-search",{attrs:{slot:"title",shape:"round",placeholder:"赶快查找你喜欢的商品吧~",autofocus:""},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.buttonSearchHandle.apply(null,arguments)}},slot:"title",model:{value:t.keyword,callback:function(e){t.keyword="string"===typeof e?e.trim():e},expression:"keyword"}}),e("van-button",{attrs:{slot:"right",size:"small",color:"#1baeae"},on:{click:t.buttonSearchHandle},slot:"right"},[t._v("搜索")])],1),e("van-dropdown-menu",{attrs:{"active-color":"#1baeae"}},[e("van-dropdown-item",{attrs:{options:t.categoryOptions},on:{change:t.dropDownChange},model:{value:t.goodsCategoryId,callback:function(e){t.goodsCategoryId=e},expression:"goodsCategoryId"}}),e("van-dropdown-item",{attrs:{options:[{text:"综合排序",value:""},{text:"时间排序",value:"new"},{text:"价格排序",value:"price"}]},on:{change:t.dropDownChange},model:{value:t.orderBy,callback:function(e){t.orderBy=e},expression:"orderBy"}})],1),e("div",{ref:"content",staticClass:"content"},[t.searchList?t._e():e("van-empty",{attrs:{image:s(6717),description:"赶快搜索你想要的商品吧~"}}),t.searchList&&0===t.searchList.length?e("van-empty",{attrs:{description:"sorry,没有找到相关信息!"}},[e("van-button",{attrs:{plain:"",color:"#1baeae"},on:{click:t.reset}},[t._v("重置搜索条件")])],1):t._e(),t.searchList&&t.searchList.length>0?e("van-list",{attrs:{finished:t.finished,"finished-text":"我是有底线的!"},on:{load:t.loadMore},model:{value:t.listLoading,callback:function(e){t.listLoading=e},expression:"listLoading"}},t._l(t.searchList,(function(t){return e("goods-item",{key:t.goodsId,attrs:{info:t}})})),1):t._e()],1)],1)])},r=[],a=(s(560),{name:"Search",props:[],data(){let{categoryId:t}=this.$route.query;return{keyword:"",goodsCategoryId:t?String(t):0,orderBy:"",pageNumber:1,searchList:null,listLoading:!1,finished:!1}},components:{},async created(){this.$store.state.category.list||await this.$store.dispatch("category/setListAsync"),this.goodsCategoryId&&this.init()},computed:{categoryOptions(){let t=this.$store.state.category.list||[],e=[{text:"全部商品",value:0}];const s=t=>{Array.isArray(t)&&0!==t.length&&t.forEach((t=>{let{categoryLevel:o,secondLevelCategoryVOS:r,thirdLevelCategoryVOS:a,categoryId:i,categoryName:n}=t;1!==+o?2!==+o?3===+o&&e.push({text:n,value:String(i)}):s(a):s(r)}))};return s(t),e}},mounted(){},methods:{reset(){this.pageNumber=1,this.searchList=null,this.keyword="",this.$refs["content"].scrollTop=0,this.goodsCategoryId=0,this.orderBy=""},buttonSearchHandle(){this.pageNumber=1,this.init(),this.$refs["content"].scrollTop=0},dropDownChange(){this.pageNumber=1,this.init(),this.$refs["content"].scrollTop=0},loadMore(){this.pageNumber++,this.init()},async init(){let t,{pageNumber:e,keyword:s,orderBy:o,goodsCategoryId:r,searchList:a}=this;if(this.finished=!1,""===s&&0===r)return this.$toast.fail("请先输入商品关键词"),this.pageNumber=1,void(this.searchList=null);try{1===+e&&(t=this.$overlay());let{resultCode:a,data:i}=await this.$API.querySearchList(e,s,o,r);if(200===+a){let{list:s,totalPage:o}=i;return void(1===+e?(this.searchList=s,t&&t.close()):(this.searchList=this.searchList.concat(s),this.listLoading=!1,this.pageNumber>=e&&(this.finished=!0)))}this.$toast.fail("网络繁忙,请求失败!")}catch(i){}t&&t.close()}}}),i=a,n=s(1001),l=(0,n.Z)(i,o,r,!1,null,"dc91b01a",null),c=l.exports},6717:function(t,e,s){t.exports=s.p+"img/kesrtd.eae122b9.png"}}]);